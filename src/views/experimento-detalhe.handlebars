
<main style="max-width:800px;margin:2.5em auto;padding:2em 1em;background:#fff;border-radius:18px;box-shadow:0 2px 24px #2563eb11;">
  <div style="display:flex;flex-wrap:wrap;align-items:center;gap:2em;justify-content:space-between;">
    <div style="flex:1 1 320px;min-width:220px;">
      <h2 style="color:#2563eb;font-size:2em;margin-bottom:0.2em;">{{exp.titulo}}</h2>
      <div style="color:#64748b;font-size:1.1em;margin-bottom:0.7em;">
        <b>N칤vel:</b> {{exp.nivel}} &nbsp;|&nbsp; <b>Tema:</b> {{exp.tema}}
      </div>
      <p style="font-size:1.13em;color:#334155;margin-bottom:1.2em;">{{exp.resumo}}</p>
      <div style="display:flex;gap:1em;align-items:center;flex-wrap:wrap;">
        <form method="post" action="/experimentos/{{exp.id}}/{{#if liked}}unlike{{else}}like{{/if}}" style="display:inline">
          <button type="submit" class="cta-secondary" style="font-size:1.1em;">
            {{#if liked}}游눛 Descurtir{{else}}游밼 Curtir{{/if}} ({{likeCount}})
          </button>
        </form>
        <form method="post" action="/experimentos/{{exp.id}}/explicar" style="display:inline;">
          <input type="hidden" name="pergunta" value="Explique o experimento: {{exp.titulo}}. {{exp.resumo}}">
          <button type="submit" class="cta" style="font-size:1.1em;">Explicar com IA</button>
        </form>
      </div>
    </div>
    {{#if exp.imagem}}
      <div style="flex:1 1 220px;min-width:180px;text-align:center;">
        <img src="{{exp.imagem}}" alt="{{exp.titulo}}" style="width:100%;max-width:260px;border-radius:12px;box-shadow:0 2px 12px #2563eb22;">
      </div>
    {{/if}}
  </div>

  {{#if exp.video}}
    <div style="margin:2em 0;text-align:center;">
      <iframe width="420" height="236" src="{{exp.video}}" frameborder="0" allowfullscreen style="border-radius:12px;box-shadow:0 2px 12px #2563eb22;"></iframe>
    </div>
  {{/if}}

  {{#if explicacaoIA}}
    <div style="background:linear-gradient(90deg,#f1f5f9 60%,#dbeafe 100%);padding:1.2em 1em;border-radius:14px;margin:2em 0;box-shadow:0 2px 8px #2563eb11;display:flex;align-items:center;gap:1em;">
      <img src="/images/ia-bot.svg" alt="IA" style="width:40px;height:40px;">
      <div>
        <strong style="color:#2563eb;">IA Explicadora:</strong><br>
        <span>{{explicacaoIA}}</span>
      </div>
    </div>
  {{/if}}

  <section style="display:grid;grid-template-columns:1fr 1fr;gap:2em;margin:2.5em 0;">
    <div class="post-card" style="min-width:180px;">
      <h3 style="color:#2563eb;margin-bottom:0.5em;">Materiais necess치rios</h3>
      <ul style="padding-left:1.2em;">
        {{#each (splitLines exp.materiais)}}
          <li>{{this}}</li>
        {{/each}}
      </ul>
    </div>
    <div class="post-card" style="min-width:180px;">
      <h3 style="color:#2563eb;margin-bottom:0.5em;">Passo a passo</h3>
      <ol style="padding-left:1.2em;">
        {{#each (splitLines exp.passos)}}
          <li>{{this}}</li>
        {{/each}}
      </ol>
    </div>
  </section>


  <section style="margin:2.5em 0;">
    <h3 style="color:#2563eb;">Coment치rios, d칰vidas e sugest칫es</h3>
      {{#if userId}}
        <form method="post" action="/experimentos/{{exp.id}}/comentar" style="margin-bottom:1.5em;">
          <textarea name="texto" placeholder="Deixe seu coment치rio, d칰vida ou sugest칚o..." required style="width:100%;min-height:60px;padding:0.8em;border-radius:8px;border:1px solid #e5e7eb;"></textarea>
          <button type="submit" class="cta" style="margin-top:0.5em;">Enviar</button>
        </form>
      {{else}}
        <div style="margin-bottom:1.5em;background:#f1f5f9;padding:1em;border-radius:8px;color:#64748b;">
          <b>Fa칞a login para comentar!</b><br>
          <a href="/login" class="cta" style="margin-right:0.7em;">Entrar</a>
          <a href="/cadastro" class="cta-secondary">Criar conta gr치tis</a>
        </div>
      {{/if}}
    <div style="margin-bottom:1em;color:#64748b;font-size:1.08em;">
      {{#if comentarios.length}}
        <b>{{comentarios.length}}</b> coment치rio{{#unless (eq comentarios.length 1)}}s{{/unless}} no total:
      {{else}}
        Nenhum coment치rio ainda.
      {{/if}}
    </div>
    <ul style="list-style:none;padding:0;">
      {{#each comentarios}}
        <li style="background:#f1f5f9;margin-bottom:0.7em;padding:0.7em 1em;border-radius:8px;box-shadow:0 1px 4px #2563eb11;">
          <strong style="color:#2563eb;">{{nome}}:</strong> {{texto}} <small style="color:#64748b;">({{criado_em}})</small>
        </li>
      {{/each}}
    </ul>
  </section>

  <div style="text-align:center;margin-top:2em;">
    <a href="/experimentos" class="cta-secondary">Voltar para a biblioteca</a>
  </div>
</main>
<script src="/js/experimento.js"></script>
